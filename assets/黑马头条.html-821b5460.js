const n=JSON.parse('{"key":"v-6e765dd9","path":"/project/%E9%BB%91%E9%A9%AC%E5%A4%B4%E6%9D%A1/%E9%BB%91%E9%A9%AC%E5%A4%B4%E6%9D%A1.html","title":"黑马头条1","lang":"zh-CN","frontmatter":{"title":"黑马头条1","date":"2023-11-23T00:00:00.000Z","category":["项目实战","黑马头条"],"tag":["项目实战","黑马头条"],"description":"黑马头条1 登录逻辑 @Override public ResponseResult login(LoginDto loginDto) { //nomal login need phone and password if (!StringUtils.isAnyBlank(loginDto.getPhone(), loginDto.getPassword())) { ApUser apUser = this.lambdaQuery() .eq(ApUser::getPhone, loginDto.getPhone()) .one(); if (apUser == null) { return ResponseResult.errorResult(AppHttpCodeEnum.DATA_NOT_EXIST, \\"用户不存在\\"); } String salt = apUser.getSalt(); String password = loginDto.getPassword(); String encryptPassword = DigestUtils.md5DigestAsHex((password + salt).getBytes()); if (!encryptPassword.equals(apUser.getPassword())) { return ResponseResult.errorResult(AppHttpCodeEnum.LOGIN_PASSWORD_ERROR); } //正确，返回jwt信息 HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;(); String token = AppJwtUtil.getToken(apUser.getId().longValue()); map.put(\\"token\\", token); apUser.setPassword(\\"\\"); apUser.setSalt(\\"\\"); map.put(\\"user\\", apUser); return ResponseResult.okResult(map); } HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;(); String token = AppJwtUtil.getToken(0L); map.put(\\"token\\", token); return ResponseResult.okResult(map); }","head":[["meta",{"property":"og:url","content":"https://github.com/yunfeidog/project/%E9%BB%91%E9%A9%AC%E5%A4%B4%E6%9D%A1/%E9%BB%91%E9%A9%AC%E5%A4%B4%E6%9D%A1.html"}],["meta",{"property":"og:site_name","content":"全民制作人ikun"}],["meta",{"property":"og:title","content":"黑马头条1"}],["meta",{"property":"og:description","content":"黑马头条1 登录逻辑 @Override public ResponseResult login(LoginDto loginDto) { //nomal login need phone and password if (!StringUtils.isAnyBlank(loginDto.getPhone(), loginDto.getPassword())) { ApUser apUser = this.lambdaQuery() .eq(ApUser::getPhone, loginDto.getPhone()) .one(); if (apUser == null) { return ResponseResult.errorResult(AppHttpCodeEnum.DATA_NOT_EXIST, \\"用户不存在\\"); } String salt = apUser.getSalt(); String password = loginDto.getPassword(); String encryptPassword = DigestUtils.md5DigestAsHex((password + salt).getBytes()); if (!encryptPassword.equals(apUser.getPassword())) { return ResponseResult.errorResult(AppHttpCodeEnum.LOGIN_PASSWORD_ERROR); } //正确，返回jwt信息 HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;(); String token = AppJwtUtil.getToken(apUser.getId().longValue()); map.put(\\"token\\", token); apUser.setPassword(\\"\\"); apUser.setSalt(\\"\\"); map.put(\\"user\\", apUser); return ResponseResult.okResult(map); } HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;(); String token = AppJwtUtil.getToken(0L); map.put(\\"token\\", token); return ResponseResult.okResult(map); }"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-28T07:33:06.000Z"}],["meta",{"property":"article:author","content":"全民制作人ikun"}],["meta",{"property":"article:tag","content":"项目实战"}],["meta",{"property":"article:tag","content":"黑马头条"}],["meta",{"property":"article:published_time","content":"2023-11-23T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-28T07:33:06.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"黑马头条1\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-11-23T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-28T07:33:06.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"全民制作人ikun\\",\\"url\\":\\"https://github.com/yunfeidog\\"}]}"]]},"headers":[{"level":2,"title":"登录逻辑","slug":"登录逻辑","link":"#登录逻辑","children":[]},{"level":2,"title":"整合Swagger","slug":"整合swagger","link":"#整合swagger","children":[]},{"level":2,"title":"整合knife4j","slug":"整合knife4j","link":"#整合knife4j","children":[]},{"level":2,"title":"网关","slug":"网关","link":"#网关","children":[]},{"level":2,"title":"文章列表 数据库拆分","slug":"文章列表-数据库拆分","link":"#文章列表-数据库拆分","children":[{"level":3,"title":"表的拆分-垂直分表","slug":"表的拆分-垂直分表","link":"#表的拆分-垂直分表","children":[]},{"level":3,"title":"文章列表查询","slug":"文章列表查询","link":"#文章列表查询","children":[]},{"level":3,"title":"业务代码","slug":"业务代码","link":"#业务代码","children":[]}]},{"level":2,"title":"Freemarker模版文件+Minio文件上传","slug":"freemarker模版文件-minio文件上传","link":"#freemarker模版文件-minio文件上传","children":[]}],"git":{"createdTime":1700968577000,"updatedTime":1714289586000,"contributors":[{"name":"yunfeidog","email":"1844025705@qq.com","commits":2}]},"readingTime":{"minutes":5.02,"words":1506},"filePathRelative":"project/黑马头条/黑马头条.md","localizedDate":"2023年11月23日","excerpt":"<h1> 黑马头条1</h1>\\n<h2> 登录逻辑</h2>\\n<div class=\\"language-java line-numbers-mode\\" data-ext=\\"java\\"><pre class=\\"language-java\\"><code>    <span class=\\"token annotation punctuation\\">@Override</span>\\n    <span class=\\"token keyword\\">public</span> <span class=\\"token class-name\\">ResponseResult</span> <span class=\\"token function\\">login</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">LoginDto</span> loginDto<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n        <span class=\\"token comment\\">//nomal login need phone and password</span>\\n        <span class=\\"token keyword\\">if</span> <span class=\\"token punctuation\\">(</span><span class=\\"token operator\\">!</span><span class=\\"token class-name\\">StringUtils</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">isAnyBlank</span><span class=\\"token punctuation\\">(</span>loginDto<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getPhone</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span> loginDto<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getPassword</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n            <span class=\\"token class-name\\">ApUser</span> apUser <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">this</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">lambdaQuery</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span>\\n                    <span class=\\"token punctuation\\">.</span><span class=\\"token function\\">eq</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">ApUser</span><span class=\\"token operator\\">::</span><span class=\\"token function\\">getPhone</span><span class=\\"token punctuation\\">,</span> loginDto<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getPhone</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span>\\n                    <span class=\\"token punctuation\\">.</span><span class=\\"token function\\">one</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            <span class=\\"token keyword\\">if</span> <span class=\\"token punctuation\\">(</span>apUser <span class=\\"token operator\\">==</span> <span class=\\"token keyword\\">null</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n                <span class=\\"token keyword\\">return</span> <span class=\\"token class-name\\">ResponseResult</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">errorResult</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">AppHttpCodeEnum</span><span class=\\"token punctuation\\">.</span><span class=\\"token constant\\">DATA_NOT_EXIST</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\\"用户不存在\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            <span class=\\"token punctuation\\">}</span>\\n            <span class=\\"token class-name\\">String</span> salt <span class=\\"token operator\\">=</span> apUser<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getSalt</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            <span class=\\"token class-name\\">String</span> password <span class=\\"token operator\\">=</span> loginDto<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getPassword</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            <span class=\\"token class-name\\">String</span> encryptPassword <span class=\\"token operator\\">=</span> <span class=\\"token class-name\\">DigestUtils</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">md5DigestAsHex</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">(</span>password <span class=\\"token operator\\">+</span> salt<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getBytes</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            <span class=\\"token keyword\\">if</span> <span class=\\"token punctuation\\">(</span><span class=\\"token operator\\">!</span>encryptPassword<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">equals</span><span class=\\"token punctuation\\">(</span>apUser<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getPassword</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n                <span class=\\"token keyword\\">return</span> <span class=\\"token class-name\\">ResponseResult</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">errorResult</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">AppHttpCodeEnum</span><span class=\\"token punctuation\\">.</span><span class=\\"token constant\\">LOGIN_PASSWORD_ERROR</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            <span class=\\"token punctuation\\">}</span>\\n            <span class=\\"token comment\\">//正确，返回jwt信息</span>\\n            <span class=\\"token class-name\\">HashMap</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token class-name\\">String</span><span class=\\"token punctuation\\">,</span> <span class=\\"token class-name\\">Object</span><span class=\\"token punctuation\\">&gt;</span></span> map <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">HashMap</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token punctuation\\">&gt;</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            <span class=\\"token class-name\\">String</span> token <span class=\\"token operator\\">=</span> <span class=\\"token class-name\\">AppJwtUtil</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getToken</span><span class=\\"token punctuation\\">(</span>apUser<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getId</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">longValue</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            map<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">put</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"token\\"</span><span class=\\"token punctuation\\">,</span> token<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            apUser<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">setPassword</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            apUser<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">setSalt</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            map<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">put</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"user\\"</span><span class=\\"token punctuation\\">,</span> apUser<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n            <span class=\\"token keyword\\">return</span> <span class=\\"token class-name\\">ResponseResult</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">okResult</span><span class=\\"token punctuation\\">(</span>map<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token punctuation\\">}</span>\\n        <span class=\\"token class-name\\">HashMap</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token class-name\\">String</span><span class=\\"token punctuation\\">,</span> <span class=\\"token class-name\\">Object</span><span class=\\"token punctuation\\">&gt;</span></span> map <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">HashMap</span><span class=\\"token generics\\"><span class=\\"token punctuation\\">&lt;</span><span class=\\"token punctuation\\">&gt;</span></span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token class-name\\">String</span> token <span class=\\"token operator\\">=</span> <span class=\\"token class-name\\">AppJwtUtil</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">getToken</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">0L</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n        map<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">put</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"token\\"</span><span class=\\"token punctuation\\">,</span> token<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n        <span class=\\"token keyword\\">return</span> <span class=\\"token class-name\\">ResponseResult</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">okResult</span><span class=\\"token punctuation\\">(</span>map<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","copyright":{"author":"全民制作人cxk","license":"CC-BY-NC-SA-4.0"},"autoDesc":true}');export{n as data};
